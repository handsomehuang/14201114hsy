<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/html">
<head>
    <title>惠Go-个人中心</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="keywords" content="Modern Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template,
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design"/>
    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap/bootstrap1.min.css" rel='stylesheet' type='text/css'/>
    <link href="/css/bootstrap/bootstrap-select.min.css" rel='stylesheet' type='text/css'/>
    <link href="/css/bootstrap/custom.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="/css/bootstrap/mystyle.css" rel='stylesheet' type='text/css'/>
    <link href="/css/bootstrap/style3.css" rel='stylesheet' type='text/css'/>
    <link href="/css/bootstrap/font-awesome.css" rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon"
          href="http://benefit-go.oss-cn-hangzhou.aliyuncs.com/webRes/img/favicon.ico"/>
    <link href="https://cdn.bootcss.com/iview/2.4.0/styles/iview.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
    <!----webfonts--->
    <!---//webfonts--->
    <!-- Bootstrap Core JavaScript -->
    <script src="/js/myfunction.js" charset="utf-8"></script>
    <script src="/js/bootstrap/bootstrap1.min.js"></script>
    <script src="/js/bootstrap-select.min.js"></script>
</head>
<body style="background-color: white">

<div id="app">
    <div id="wrapper">
        <div class="navbar navbar-default" role="navigation" style="padding-left:20px;margin-bottom:0px">
            <div>
                <label class="navbar-text navbar-left" id="Hello">{{user.nickName}}</label>
                <button class="btn btn-link btn-lg navbar-left">消息（）</button>
                <button class="btn btn-link btn-lg navbar-right" style="margin-right:100px">联系客服</button>
                <button class="btn btn-link btn-lg navbar-right">卖家中心</button>
                <button class="btn btn-link btn-lg navbar-right">商品分类</button>
                <button class="btn btn-link btn-lg navbar-right">收藏夹</button>
                <button class="btn btn-link btn-lg navbar-right">个人中心</button>
                <button class="btn btn-link btn-lg navbar-right" onclick="window.location.href='/index'">我的惠Go</button>
                <button class="btn btn-link btn-lg navbar-right" onclick="window.location.href='/index'">惠Go网首页</button>
            </div>
        </div>

        <div class="panel panel-heading row flexbox">
            <h1 class="col-md-2  text-left">我的惠Go</h1>
            <a href="/person" class="btn btn-link btn-lg col-md-1">首页</a>
            <a href="##" class="btn btn-link btn-lg col-md-1">账户设置</a>
            <a href="##" class="btn btn-link btn-lg col-md-1">消息</a>
            <div class="col-md-3 col-md-offset-3">
                <form action="##" class="navbar-form " rol="search">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="请输入关键词"/>
                    </div>
                    <button type="submit" class="btn btn-default">搜索</button>
                </form>
            </div>
        </div>
        <!--下拉菜单-->
        <div class="navbar-default sidebar" role="navigation" style="background-color: whitesmoke;margin-top: 0px">
            <div class="sidebar-nav navbar-collapse">
                <ul class="nav" id="side-menu">

                    <li>
                        <a href="#"><i class="fa fa-dashboard fa-fw nav_icon"></i>商家<span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li>
                                <a href="/user/businessOrderManage"></i>订单管理</a>
                            </li>
                            <li>
                                <a href="/user/businessInfoManage"></i>商家信息</a>
                            </li>
                            <li>
                                <a href="/user/businessGoodsInfo"></i>商品管理</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- /.sidebar-collapse -->
        </div>

        <!-- /.navbar-static-side -->
        <!-- 右边信息 -->

        <!--<div class="col-md-3 col-md-offset-3" style="border: solid 1px red">-->
        <!--<form action="##" class="navbar-form " rol="search">-->
        <!--<div class="form-group">-->
        <!--<input type="text" class="form-control" placeholder="请输入关键词"/>-->
        <!--</div>-->
        <!--<button type="submit" class="btn btn-default">搜索</button>-->
        <!--</form>-->
        <!--</div>-->
        <div id="page-wrapper">
            <div class="col-md-12 graphs">
                <div class="xs">
                    <h2>商品管理</h2>
                    <div class="panel-body1">
                        <!-- 模态按钮 -->
                        操作：
                        <button class="btn btn-primary" id="btnUpGoodsInfo" @click="loadGoodsToModel">编辑</button>
                        <button class="btn btn-primary" id="btnAddGoodsInfo" data-toggle="modal"
                                data-target="#addGoods">增加
                        </button>
                        <button class="btn btn-primary" id="btnDelGoodsInfo">删除</button>

                        <div class="modal fade" id="upGoodsInfo" tabindex="-1" role="dialog"
                             aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &times;
                                        </button>
                                        <h4 class="modal-title" id="myModalLabel">商品信息</h4>
                                    </div>
                                    <div class="modal-body"><!-- enctype="multipart/form-data"-->
                                        <i-form label-position="left" :label-width="75">
                                            <input type="text" id="updateGoods" name="updateGoods" hidden="hidden"/>
                                            <input type="text" id="goodsId" name="goodsId" hidden="hidden"/>
                                            <input type="text" id="shopId" name="shopId" hidden="hidden">

                                            <img id="updateGoodsImg"
                                                 class="img-rounded" height="100px"
                                                 width="100px"
                                                 :src="goodsSelected.picture">
                                            <!--<td style="height:100px;vertical-align:middle"><input type="file"name="updateGoodsImg"></td>-->
                                            <form-item>
                                                <Upload :action="url.uploadUrl" :on-success="handleSuccess"
                                                        accept="image/*"
                                                        :before-upload="handleBeforeUpload"
                                                        :on-error="uploadFailed" :show-upload-list="true">
                                                    <i-button type="ghost" icon="ios-cloud-upload-outline">
                                                        上传文件
                                                    </i-button>
                                                </Upload>
                                            </form-item>

                                            <form-item label="商品名称">
                                                <i-input type="text" id="goodsName" name="name" placeholder="商品名称"
                                                         v-model="goodsSelected.name"></i-input>
                                            </form-item>
                                            <form-item label="原 价">
                                                <i-input type="number" id="originalprice" name="originalprice"
                                                         placeholder="原价 ￥" v-model="goodsSelected.originalprice"
                                                         required></i-input>
                                            </form-item>
                                            <form-item label="团购价">
                                                <i-input type="number" id="preferentialprice"
                                                         name="preferentialprice"
                                                         placeholder="团购价 ￥" required autofocus
                                                         v-model="goodsSelected.preferentialprice">
                                                </i-input>
                                            </form-item>
                                            <form-item label="总库存量">
                                                <i-input type="number" id="total_inventory" name="total_inventory"
                                                         placeholder="总库存量" required
                                                         autofocus v-model="goodsSelected.totalInventory"
                                                ></i-input>
                                            </form-item>
                                            <form-item label="剩余库存量">
                                                <i-input type="number" id="surplus_inventory"
                                                         name="surplus_inventory"
                                                         v-model="goodsSelected.surplusInventory"
                                                         placeholder="剩余库存量" required autofocus></i-input>
                                            </form-item>
                                            <form-item label="商品描述">
                                                <i-input type="text" id="description" name="description"
                                                         placeholder="商品描述" required
                                                         v-model="goodsSelected.description"
                                                         autofocus></i-input>
                                            </form-item>
                                            <form-item label="商品类别">
                                                <i-input type="number" id="category" name="category" placeholder="商品类别"
                                                         v-model="goodsSelected.category"></i-input>
                                            </form-item>
                                            <form-item label="是否上架">
                                                <select id="isonshelves" name="isonshelves"
                                                        v-model="goodsSelected.isonshelves"
                                                        style="text-align:center">
                                                    <option value="true">上架</option>
                                                    <option value="false">下架</option>
                                                </select>
                                            </form-item>

                                            <div class="modal-footer">
                                                <i-button class="btn btn-primary" @click="updateGoods">提交</i-button>
                                            </div>
                                        </i-form>
                                    </div>
                                </div><!-- /.modal-content -->
                            </div><!-- /.modal -->
                        </div>
                        <!-- /.编辑商品信息模态框 -->

                        <!-- 添加商品信息模态框 -->
                        <div class="modal fade" id="addGoods" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                             aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &times;
                                        </button>
                                        <h4 class="modal-title" id="myModalLabe">添加商品</h4>
                                    </div>

                                    <div class="modal-body">
                                        <i-form label-position="left" :label-width="75">
                                            <input type="text" name="updateGoods" hidden="hidden"/>
                                            <input type="text" name="goodsId" hidden="hidden"/>
                                            <input type="text" name="shopId" hidden="hidden">

                                            <img id="addGoodsImg"
                                                 class="img-rounded" height="100px"
                                                 width="100px"
                                                 :src="newGoods.picture">
                                            <!--<td style="height:100px;vertical-align:middle"><input type="file"name="updateGoodsImg"></td>-->
                                            <form-item>
                                                <Upload :action="url.uploadUrl" :on-success="addGoodsUpload"
                                                        accept="image/*"
                                                        :on-error="uploadFailed" :show-upload-list="true">
                                                    <i-button type="ghost" icon="ios-cloud-upload-outline">
                                                        上传文件
                                                    </i-button>
                                                </Upload>
                                            </form-item>

                                            <form-item label="商品名称">
                                                <i-input type="text" id="goodsName" name="name" placeholder="商品名称"
                                                         v-model="newGoods.name"></i-input>
                                            </form-item>
                                            <form-item label="原 价">
                                                <i-input type="number" id="originalprice" name="originalprice"
                                                         placeholder="原价 ￥" v-model="newGoods.originalprice"
                                                         required></i-input>
                                            </form-item>
                                            <form-item label="团购价">
                                                <i-input type="number" id="preferentialprice"
                                                         name="preferentialprice"
                                                         placeholder="团购价 ￥" required autofocus
                                                         v-model="newGoods.preferentialprice">
                                                </i-input>
                                            </form-item>
                                            <form-item label="总库存量">
                                                <i-input type="number" id="total_inventory" name="total_inventory"
                                                         placeholder="总库存量" required
                                                         autofocus v-model="newGoods.totalInventory"
                                                ></i-input>
                                            </form-item>
                                            <form-item label="剩余库存量">
                                                <i-input type="number" id="surplus_inventory"
                                                         name="surplus_inventory"
                                                         v-model="newGoods.surplusInventory"
                                                         placeholder="剩余库存量" required autofocus></i-input>
                                            </form-item>
                                            <form-item label="商品描述">
                                                <i-input type="text" id="description" name="description"
                                                         placeholder="商品描述" required
                                                         v-model="newGoods.description"
                                                         autofocus></i-input>
                                            </form-item>
                                            <form-item label="商品类别">
                                                <i-input type="number" id="category" name="category" placeholder="商品类别"
                                                         v-model="newGoods.category"></i-input>
                                            </form-item>
                                            <form-item label="是否上架">
                                                <select id="isonshelves" name="isonshelves"
                                                        v-model="newGoods.isonshelves"
                                                        style="text-align:center">
                                                    <option value="true">上架</option>
                                                    <option value="false">下架</option>
                                                </select>
                                            </form-item>

                                            <div class="modal-footer">
                                                <button class="btn btn-primary" id="btnAddGoods" @click="addNewGoods">提交
                                                </button>
                                            </div>
                                        </i-form>
                                    </div><!-- /.modal-content -->
                                </div><!-- /.modal -->
                            </div>
                        </div>
                        <!-- /. 添加菜品信息模态框 -->


                        <table class="table">
                            <thead>
                            <tr>
                                <th>选择</th>
                                <th>商品编号</th>
                                <th>商品名称</th>
                                <th>原价</th>
                                <th>团购价</th>
                                <th>库存量</th>
                                <th>上架状态</th>
                                <th>商品描述</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="(goods,index) in goodsList" :key="goods.id">
                                <td scope="row">
                                    <!--"-->
                                    <input type="radio" id="inputGoodsId" name="goodsId" :value="index"/>
                                </td>
                                <td>{{goods.id}}</td>
                                <td>{{goods.name}}</td>
                                <td>{{goods.originalprice}}</td>
                                <td>{{goods.preferentialprice}}</td>
                                <td>{{goods.totalInventory}}</td>
                                <td>{{goods.isonshelves}}</td>
                                <td>{{goods.description}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>


                    <!-- /#page-wrapper -->
                </div>
            </div>


        </div>
        <div class="panel panel-footer row">
            <div class="col-md-12" style="text-align: center">
                <div class="col-md-1 col-md-offset-4 text-center">
                    <ul class="list-unstyled">
                        <li><label>关于惠Go网</label>
                        <li>
                            <button class="btn btn-link" type="button">帮助中心</button>
                        <li>
                            <button class="btn btn-link" type="button">诚聘英才</button>
                        <li>
                            <button class="btn btn-link" type="button">法律声明</button>
                    </ul>
                </div>
                <div class="col-md-1 text-center">
                    <ul class="list-unstyled">
                        <li><label>买家中心</label>
                        <li>
                            <button class="btn btn-link" type="button">在线答疑</button>
                        <li>
                            <button class="btn btn-link" type="button">服务保障</button>
                    </ul>
                </div>
                <div class="col-md-1 text-center">
                    <ul class="list-unstyled">
                        <li><label>卖家中心</label>
                        <li>
                            <button class="btn btn-link" type="button">在线咨询</button>
                        <li>
                            <button class="btn btn-link" type="button">商品报名</button>
                        <li>
                            <button class="btn btn-link" type="button">商家规则</button>
                        <li>
                            <button class="btn btn-link" type="button">规则通知</button>
                    </ul>
                </div>
                <div class="col-md-1 text-center">
                    <ul class="list-unstyled">
                        <li><label>有话要说</label>
                        <li>
                            <button class="btn btn-link" type="button">客服热线</button>
                        <li>
                            <button class="btn btn-link" type="button">廉政举报</button>
                        <li>
                            <button class="btn btn-link" type="button">我要投诉</button>
                    </ul>
                </div>
                <div class="col-md-1 text-center">
                    <ul class="list-unstyled">
                        <li><label>服务保障</label>
                        <li>
                            <button class="btn btn-link" type="button">七天无理由退换货</button>
                        <li>
                            <button class="btn btn-link" type="button">维修/保养</button>
                        <li>
                            <button class="btn btn-link" type="button">购买延保服务</button>
                        <li>
                            <button class="btn btn-link" type="button">退换货政策</button>
                    </ul>
                </div>
            </div>
            <p>&nbsp;
            <p>&nbsp;
                <div class="col-md-12">
                    <div class="row text-center">
                        <a>关于网站</a>&nbsp;
                        <a>帮助中心</a>&nbsp;
                        <a>开放平台</a>&nbsp;
                        <a>招聘信息</a>&nbsp;
                        <a>联系我们</a>&nbsp;
                        <a>网站合作</a>&nbsp;
                        <a>法律声明及隐私权政策</a>&nbsp;
                        <a>知识产权</a>&nbsp;
                        <a>廉政举报</a>&nbsp;
                    </div>
            <p>&nbsp;
            <div class="row text-center">
                <label>增值电信业务经营许可证：xxx-xxxx</label>
                <label>网络文化经营许可证：xxx-xxxx</label>
            </div>
        </div>
    </div>
</div>

<!-- /#wrapper -->
<!-- Nav CSS -->
<script type="text/javascript" src="/js/vue/vue.js"></script>
<script type="text/javascript" src="/js/iview/iview.js"></script>
<script type="text/javascript" src="/js/axios/axios.min.js"></script>
<script type="text/javascript" src="/js/project/webRouter.js"></script>

<!-- Metis Menu Plugin JavaScript -->
<script src="/js/metisMenu.min.js"></script>
<script src="/js/custom.js"></script>

<script type="text/javascript">
    var test;
    var app = new Vue({
        el: '#app',
        data: {
            url: routerUrl,
            user: '',
            goodsList: [],
            goodsSelected: '',
            newGoods: {
                category: '',
                description: '',
                goodsPictures: [],
                id: '',
                isonshelves: '',
                name: '',
                originalprice: '',
                picture: '',
                preferentialprice: '',
                surplusInventory: '',
                totalInventory: ''
            },
            selectGoods: '',
            fileNum:
                0,
            GoodsEditMd:
                false
        },
        methods: {
            /*更新商品*/
            updateGoods: function () {
                Ajx.post('/goods/upGoods', this.goodsSelected).then(function (response) {
                    alert('商品信息更新成功');
                    $('#upGoodsInfo').modal('hide');
                }).catch(function () {
                    alert('更新失败');
                })
            },
            addNewGoods: function () {
                Ajx.post('/goods/addGoods', this.newGoods).then(function (response) {
                    alert('商品添加成功');
                    $('#addGoods').modal('hide');
                }).catch(function (error) {
                    alert('商品添加失败');
                });
            },
            loadGoodsToModel: function () {
                var datas;
                var checked = $("input[type='radio']:checked").val();
                if (checked == undefined) {
                    alert('请选择一件商品');
                } else {
                    this.goodsSelected = this.goodsList[checked];
                    $('#upGoodsInfo').modal('show');
                }
            }
            ,
            uploadFailed: function (file) {
                if (this.fileNum == 1) {
                    this.fileNum = 0;
                }
                this.$Notice.error({
                    title: '上传失败,请重试!'
                });
            }
            ,
            handleBeforeUpload: function () {
                return true;
            },
            /*添加商品时图片上传*/
            addGoodsUpload: function (response) {
                app.newGoods.picture = response;
                alert('图片上传成功');
            },
            /*更新商品信息时文件上传完成获取图片url*/
            handleSuccess: function (response) {
                app.goodsSelected.picture = response;
                alert('图片上传成功');
            }
        }
        ,
        created: function () {
            getLoginUser();
            getGoodsList();
        }
    })
    var goodsInfo = new Vue({
        el: '#goodsInfo',
        data: {
            goods: ''
        }
    })

    /*获取登录的用户信息*/
    function getLoginUser() {
        /*先获取Session的用户信息,不存在表示用户未登录*/
        return Ajx.get(routerUrl.get.userInfo).then(function (response) {
            if (response.data != undefined) {
                app.user = response.data;
                app.isLogin = true;
            }
        }).catch(function (error) {
            app.isLogin = false;
        });
    };

    function getGoodsList() {
        Ajx.get(routerUrl.get.goodList).then(function (response) {
            app.goodsList = [];
            response.data.forEach(function (goods) {
                app.goodsList.push(goods);
            })
        })
    }

    /*
        $('#btnUpGoodsInfo').click(function () {
            var checked = $("input[type='radio']:checked");
            if (checked.val() == undefined) {
                alert('请选择一件商品');
            } else {
                $('#updateGoods').val(checked.val());
                $('#upGoodsInfo').modal('show');
                $.ajax({
                    url: "/goods/goodInfo/" + checked.val(),
                    type: "get",
                    error: function () {
                        alert("服务器连接失败");
                    },
                    success: function (response) {
                        var datas = response.data;
                        if (datas.dImage == null) {
                            datas.dImage = '/img/logo.png';
                        }
                        document.getElementById('updateGoodsImg').src = datas.dImage;
                        $('#goodsName').val(datas.name);
                        $('#originalprice').val(datas.originalprice);
                        $('#preferentialprice').val(datas.preferentialprice);
                        $('#total_inventory').val(datas.total_inventory);
                        $('#surplus_inventory').val(datas.surplus_inventory);
                        $('#description').val(datas.description);
                        $('#category').val(datas.category);
                        $('.selector').val(datas.isonshelves)
                    }
                });
            }
        });*/

    $('#btnDelGoodsInfo').click(function () {
        var checked = $("input[type='radio']:checked").val();
        if (checked == undefined) {
            alert('请选择一件商品');
        } else {
            if (confirm('确认要删除该商品吗?')) {
                Ajx.get('/goods/delGoods/' + app.goodsList[checked].id).then(function () {
                    getGoodsList();
                    alert('删除成功');
                });
            }
        }
    })

</script>

</body>
</html>
